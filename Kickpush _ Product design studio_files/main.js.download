function OnScreen(e){function t(){!c.animFrame&&c.items.length&&(c.animFrame=requestAnimationFrame(a))}function a(){c.animFrame=null,c.items.forEach(function(e){var t=e.element,a=e.options,r=e.side,o=n(e),s=e.side,c=e.offset,l={side:o?r:s,offset:c,data:a.data},d=t.getAttribute("class").match(new RegExp("\\b("+a.screenEnterClass+"|"+a.screenLeaveClass+")(-(-(top|bottom|left|right)){0,2})*","g"))||[];if(o){if(!e.onscreen){if(e.onscreen=!0,!i(t,"screenenter",l)||a.onScreenEnter&&a.onScreenEnter.call(t,l)===!1)return;d.forEach(function(e){t.classList.remove(e)}),t.classList.add(a.screenEnterClass),t.classList.add(a.screenEnterClass+"--"+r)}}else if(e.onscreen){if(e.onscreen=!1,!i(t,"screenleave",l)||a.onScreenLeave&&a.onScreenLeave.call(t,l)===!1)return;d.forEach(function(e){t.classList.remove(e)}),t.classList.add(a.screenLeaveClass),t.classList.add(a.screenLeaveClass+"--"+s)}!a.disableScreenMove&&(o||a.fireScreenMoveOffScreen)&&(!i(t,"screenmove",l)||a.onScreenMove&&a.onScreenMove.call(t,l)===!1)})}function n(e){var t=e.element.getBoundingClientRect(),a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0,width:window.innerWidth,height:window.innerHeight},n=r(t,e.options.target),o=r(a,e.options.screen),i=n.top-o.top,s=o.right-n.right,c=o.bottom-n.bottom,l=n.left-o.left,d=o.height-n.height,u=o.width-n.width,f=o.height+n.height,h=o.width+n.width,p={top:i/o.height,right:s/o.width,bottom:c/o.height,left:l/o.width,inside:{top:i/d,right:s/u,bottom:c/d,left:l/u},outside:{top:(n.bottom-o.top)/f,right:(o.right-n.left)/h,bottom:(o.bottom-n.top)/f,left:(n.right-o.left)/h}},m=[];return n.bottom<=o.top?m[m.length]="top":n.top>=o.bottom&&(m[m.length]="bottom"),n.right<=o.left?m[m.length]="left":n.left>=o.right&&(m[m.length]="right"),e.offset=p,m.length?(e.side=m.join("-"),!1):!0}function r(e,t){var a=e.width||e.right-e.left,n=e.height||e.bottom-e.top,r={};return t=t||{},r.top=e.top+(t.top?o(t.top,n):0),r.right=e.right-(t.right?o(t.right,a):0),r.bottom=e.bottom-(t.bottom?o(t.bottom,n):0),r.left=e.left+(t.left?o(t.left,a):0),r.width=r.right-r.left,r.height=r.bottom-r.top,r}function o(e,t){return/\d%$/.test(e)?parseFloat(e)/100*t:parseFloat(e||0)}function i(e,t,a){var n;return"function"==typeof CustomEvent?n=new CustomEvent(t,{detail:a,bubbles:!0,cancelable:!0}):(n=document.createEvent("CustomEvent"),n.initCustomEvent(t,!0,!0,a)),!!e.dispatchEvent(n)}function s(){var e={};return[].forEach.call(arguments,function(t){for(var a in t)t.hasOwnProperty(a)&&(t[a]&&"[object Object]"==={}.toString.call(t[a])?e[a]=s(e[a]||{},t[a]):e[a]=t[a])}),e}var c=this,l={scrollContainer:[document.body,document.documentElement,window],scroll:!0,resize:!0,load:!0};c.options=s(l,e||{}),c.animFrame=null,c.items=[],c.map={},c.update=t,c.util={mergeObjects:s},c.options.scroll&&[].forEach.call(c.options.scrollContainer,function(e){e.addEventListener("scroll",t)}),c.options.resize&&window.addEventListener("resize",t),c.options.load&&window.addEventListener("load",t)}window.Modernizr=function(e,t,a){function n(e){p.cssText=e}function r(e,t){return typeof e===t}var o,i,s,c="2.8.3",l={},d=!0,u=t.documentElement,f="modernizr",h=t.createElement(f),p=h.style,m=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),v={svg:"http://www.w3.org/2000/svg"},g={},b=[],y=b.slice,w=function(e,a,n,r){var o,i,s,c,l=t.createElement("div"),d=t.body,h=d||t.createElement("body");if(parseInt(n,10))for(;n--;)s=t.createElement("div"),s.id=r?r[n]:f+(n+1),l.appendChild(s);return o=["&#173;",'<style id="s',f,'">',e,"</style>"].join(""),l.id=f,(d?l:h).innerHTML+=o,h.appendChild(l),d||(h.style.background="",h.style.overflow="hidden",c=u.style.overflow,u.style.overflow="hidden",u.appendChild(h)),i=a(l,e),d?l.parentNode.removeChild(l):(h.parentNode.removeChild(h),u.style.overflow=c),!!i},S={}.hasOwnProperty;s=r(S,"undefined")||r(S.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return S.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var a=y.call(arguments,1),n=function(){if(this instanceof n){var r=function(){};r.prototype=t.prototype;var o=new r,i=t.apply(o,a.concat(y.call(arguments)));return Object(i)===i?i:o}return t.apply(e,a.concat(y.call(arguments)))};return n}),g.touch=function(){var a;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?a=!0:w(["@media (",m.join("touch-enabled),("),f,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){a=9===e.offsetTop}),a},g.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==v.svg};for(var C in g)s(g,C)&&(i=C.toLowerCase(),l[i]=g[C](),b.push((l[i]?"":"no-")+i));return l.addTest=function(e,t){if("object"==typeof e)for(var n in e)s(e,n)&&l.addTest(n,e[n]);else{if(e=e.toLowerCase(),l[e]!==a)return l;t="function"==typeof t?t():t,"undefined"!=typeof d&&d&&(u.className+=" "+(t?"":"no-")+e),l[e]=t}return l},n(""),h=o=null,function(e,t){function a(e,t){var a=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return a.innerHTML="x<style>"+t+"</style>",n.insertBefore(a.lastChild,n.firstChild)}function n(){var e=b.elements;return"string"==typeof e?e.split(" "):e}function r(e){var t=g[e[m]];return t||(t={},v++,e[m]=v,g[v]=t),t}function o(e,a,n){if(a||(a=t),d)return a.createElement(e);n||(n=r(a));var o;return o=n.cache[e]?n.cache[e].cloneNode():p.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),!o.canHaveChildren||h.test(e)||o.tagUrn?o:n.frag.appendChild(o)}function i(e,a){if(e||(e=t),d)return e.createDocumentFragment();a=a||r(e);for(var o=a.frag.cloneNode(),i=0,s=n(),c=s.length;c>i;i++)o.createElement(s[i]);return o}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(a){return b.shivMethods?o(a,e,t):t.createElem(a)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(b,t.frag)}function c(e){e||(e=t);var n=r(e);return b.shivCSS&&!l&&!n.hasCSS&&(n.hasCSS=!!a(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),d||s(e,n),e}var l,d,u="3.7.0",f=e.html5||{},h=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",v=0,g={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,d=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(a){l=!0,d=!0}}();var b={elements:f.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:u,shivCSS:f.shivCSS!==!1,supportsUnknownElements:d,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:c,createElement:o,createDocumentFragment:i};e.html5=b,c(t)}(this,t),l._version=c,l._prefixes=m,l.testStyles=w,u.className=u.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(d?" js "+b.join(" "):""),l}(this,this.document),function(e,t,a){function n(e){return"[object Function]"==v.call(e)}function r(e){return"string"==typeof e}function o(){}function i(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=g.shift();b=1,e?e.t?p(function(){("c"==e.t?f.injectCss:f.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):b=0}function c(e,a,n,r,o,c,l){function d(t){if(!h&&i(u.readyState)&&(y.r=h=1,!b&&s(),u.onload=u.onreadystatechange=null,t)){"img"!=e&&p(function(){S.removeChild(u)},50);for(var n in x[a])x[a].hasOwnProperty(n)&&x[a][n].onload()}}var l=l||f.errorTimeout,u=t.createElement(e),h=0,v=0,y={t:n,s:a,e:o,a:c,x:l};1===x[a]&&(v=1,x[a]=[]),"object"==e?u.data=a:(u.src=a,u.type=e),u.width=u.height="0",u.onerror=u.onload=u.onreadystatechange=function(){d.call(this,v)},g.splice(r,0,y),"img"!=e&&(v||2===x[a]?(S.insertBefore(u,w?null:m),p(d,l)):x[a].push(u))}function l(e,t,a,n,o){return b=0,t=t||"j",r(e)?c("c"==t?$:C,e,t,this.i++,a,n,o):(g.splice(this.i++,0,e),1==g.length&&s()),this}function d(){var e=f;return e.loader={load:l,i:0},e}var u,f,h=t.documentElement,p=e.setTimeout,m=t.getElementsByTagName("script")[0],v={}.toString,g=[],b=0,y="MozAppearance"in h.style,w=y&&!!t.createRange().compareNode,S=w?h:m.parentNode,h=e.opera&&"[object Opera]"==v.call(e.opera),h=!!t.attachEvent&&!h,C=y?"object":h?"script":"img",$=h?"script":C,E=Array.isArray||function(e){return"[object Array]"==v.call(e)},j=[],x={},L={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};f=function(e){function t(e){var t,a,n,e=e.split("!"),r=j.length,o=e.pop(),i=e.length,o={url:o,origUrl:o,prefixes:e};for(a=0;i>a;a++)n=e[a].split("="),(t=L[n.shift()])&&(o=t(o,n));for(a=0;r>a;a++)o=j[a](o);return o}function i(e,r,o,i,s){var c=t(e),l=c.autoCallback;c.url.split(".").pop().split("?").shift(),c.bypass||(r&&(r=n(r)?r:r[e]||r[i]||r[e.split("/").pop().split("?")[0]]),c.instead?c.instead(e,r,o,i,s):(x[c.url]?c.noexec=!0:x[c.url]=1,o.load(c.url,c.forceCSS||!c.forceJS&&"css"==c.url.split(".").pop().split("?").shift()?"c":a,c.noexec,c.attrs,c.timeout),(n(r)||n(l))&&o.load(function(){d(),r&&r(c.origUrl,s,i),l&&l(c.origUrl,s,i),x[c.url]=2})))}function s(e,t){function a(e,a){if(e){if(r(e))a||(u=function(){var e=[].slice.call(arguments);f.apply(this,e),h()}),i(e,u,t,0,l);else if(Object(e)===e)for(c in s=function(){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a}(),e)e.hasOwnProperty(c)&&(!a&&!--s&&(n(u)?u=function(){var e=[].slice.call(arguments);f.apply(this,e),h()}:u[c]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),h()}}(f[c])),i(e[c],u,t,c,l))}else!a&&h()}var s,c,l=!!e.test,d=e.load||e.both,u=e.callback||o,f=u,h=e.complete||o;a(l?e.yep:e.nope,!!d),d&&a(d)}var c,l,u=this.yepnope.loader;if(r(e))i(e,0,u,0);else if(E(e))for(c=0;c<e.length;c++)l=e[c],r(l)?i(l,0,u,0):E(l)?f(l):Object(l)===l&&s(l,u);else Object(e)===e&&s(e,u)},f.addPrefix=function(e,t){L[e]=t},f.addFilter=function(e){j.push(e)},f.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=d(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,a,n,r,c,l){var d,u,h=t.createElement("script"),r=r||f.errorTimeout;h.src=e;for(u in n)h.setAttribute(u,n[u]);a=l?s:a||o,h.onreadystatechange=h.onload=function(){!d&&i(h.readyState)&&(d=1,a(),h.onload=h.onreadystatechange=null)},p(function(){d||(d=1,a(1))},r),c?h.onload():m.parentNode.insertBefore(h,m)},e.yepnope.injectCss=function(e,a,n,r,i,c){var l,r=t.createElement("link"),a=c?s:a||o;r.href=e,r.rel="stylesheet",r.type="text/css";for(l in n)r.setAttribute(l,n[l]);i||(m.parentNode.insertBefore(r,m),p(a,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};var g=g||{};g.partials=["global","browserSniff","navigation","contact","parallax","history"],g._init=function(){for(var e=0;e<this.partials.length;e++){var t=g[this.partials[e]];t()}},OnScreen.prototype.addItem=function(e,t){var a={screen:{top:0,right:0,bottom:0,left:0},target:{top:0,right:0,bottom:0,left:0},screenEnterClass:"js-screenenter",screenLeaveClass:"js-screenleave",onScreenEnter:null,onScreenLeave:null,onScreenMove:null,fireScreenMoveOffScreen:!1,disableScreenMove:!1},n=this.items.length;return this.items[n]={element:e,options:this.util.mergeObjects(a,t||{}),onscreen:!1,side:"bottom"},this.map[e]=n,this.items[n]},OnScreen.prototype.updateItem=function(e,t){var a=parseInt(this.map[e]);return a>=0&&a<this.items.length&&this.items[a]&&(this.items[a].options=this.util.mergeObjects(this.items[a].options,t||{})),this.items[a]},OnScreen.prototype.removeItem=function(e){var t=parseInt(this.map[e]);t>=0&&t<this.items.length&&(this.items.splice(t,1),this.map[e]=null,delete this.map[e])},OnScreen.prototype.empty=function(){this.items=[],this.map={}},OnScreen.prototype.dispose=function(){this.empty(),this.options.scroll&&this.options.scrollContainer.forEach(function(e){e.removeEventListener("scroll",this.update)},this),this.options.resize&&window.removeEventListener("resize",this.update),this.options.load&&window.removeEventListener("load",this.update)},$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},g.global=function(){var e=g.global;e.variables={},e.roundToNum=function(e,t){return+(Math.round(e+"e+"+t)+"e-"+t)},e.cacheLoop=function(e,t){var a=$(g[e].selectors[t].parent);a.length&&a.each(function(){var a=$(this),n=$(g[e].selectors[t].child,$(this));if(a&&n)var r={parent:a,child:n};g[e].cache[t].push(r)})},e.throttle=function(e,t,a){t||(t=250);var n,r;return function(){var o=a||this,i=+new Date,s=arguments;n&&n+t>i?(clearTimeout(r),r=setTimeout(function(){n=i,e.apply(o,s)},t)):(n=i,e.apply(o,s))}},e.updateWidth=function(){e.variables.width=$(window).width()},e.init=function(){e.updateWidth()},e.init()},g.browserSniff=function(){var e=g.browserSniff;e.selectors={html:"html"},e.classes={loaded:"html--loaded"};var t=document.documentElement;t.setAttribute("data-useragent",navigator.userAgent),t.setAttribute("data-platform",navigator.platform),$(document).ready(function(){$(e.selectors.html).hasClass("touch")&&$(e.selectors.html).removeClass("hover"),window.fontsLoaded?$(e.selectors.html).addClass(e.classes.loaded):window.domLoaded=!0})},g.navigation=function(){var e=g.navigation;e.dataSet={nav:"data-nav"},e.classes={active:"nav__link--active",toggled:"js--masthead-hidden"},e.selectors={active:"."+e.classes.active,toggle:'[data-js="toggle nav"]',parent:'[data-js="toggled nav parent"]',header:{parent:"[data-masthead]"}},e.toggleNavigation=function(t){t===!0||t===!1?$(e.selectors.parent).toggleClass(e.classes.toggled,t):$(e.selectors.parent).toggleClass(e.classes.toggled)},$(document).on("click",e.selectors.toggle,function(t){t.preventDefault(),e.toggleNavigation()}),e.setActive=function(t){if($(e.selectors.active).removeClass(e.classes.active),!t)return!1;var a=$("["+e.dataSet.nav+'="'+t+'"]');a.length&&a.addClass(e.classes.active)},setupParallaxHeader=function(){var t=$(e.selectors.header.parent);return t.length?void e.onScreen.addItem(t[0],{}):!1},e.init=function(){e.onScreen=new OnScreen,setupParallaxHeader(),e.onScreen.update()},e.init()},g.share=function(){var e=g.share;e.selectors={twitterButton:"[data-js='share-on-twitter']"},e.classes={success:"btn--twitter-shared"},e.variables={success:"Thanks!"},$(document).on("click",e.selectors.twitterButton,function(t){t.preventDefault();var a=575,n=400,r=($(window).width()-a)/2,o=($(window).height()-n)/2;$("h1:first").text();url=this.href,opts="status=1,width="+a+",height="+n+",top="+o+",left="+r,window.open(url,"twitter",opts),$(this).html(e.variables.success).addClass(e.classes.success)})},g.contact=function(){var e=g.contact;e.variables={canSubmit:!1},e.validateField=function(t){var t=t||{},a=$('[data-form-field="'+t.field+'"]'),n=n=$("[data-form-error]",a),r=t.data,o=t.error,i={name:"Your name is required",email:"Your email is required",message:"Your message is required"};!r||o?(e.variables.canSubmit=!1,a.hasClass("js--error")||a.addClass("js--error js--error-hidden"),n.text(o||t.message||i[t.field]||"An error occured"),setTimeout(function(){a.removeClass("js--error-hidden")},150)):(a.removeClass("js--error"),n.text(n.attr("data-form-error")))},e.submitForm=function(t){if($(".js--contact-form-sent").length)return!1;e.variables.canSubmit=!0;var t=t||{},a=t.data,n=t.form,r=a.name||!1,o=a.email||!1,i=a.message||!1,s=[{field:"name",data:r,message:"Your name is required"},{field:"email",data:o,message:"Your email is required"},{field:"message",data:i,message:"Your message is required"}];$.each(s,function(t,a){e.validateField(a)}),e.variables.canSubmit&&($("[data-form-validate]").text("Sending\u2026"),$.ajax({url:n.attr("action"),dataType:"json",xhrFields:{withCredentials:!1},method:"POST",data:{_replyto:o,_format:"plain",_subject:"Kickpush Contact Request",message:i,name:r}}).done(function(e){$("[data-form-validate]").text("Sent").addClass("js--contact-form-sent")}).fail(function(e){console.log("Fail",e)}))},$(document).on("submit","[data-form]",function(t){t.preventDefault();var a=$(this),n=a.serializeObject();e.submitForm({form:a,data:n})}),$(document).on("focus","[data-form] input, [data-form] textarea",function(e){var t=$(this).parent();t.addClass("js--form-field-focused")}).on("blur","[data-form] input, [data-form] textarea",function(t){if(!$(this).val()){var a=$(this).parent();a.removeClass("js--form-field-focused")}e.validateField({field:$(this).attr("name"),data:$(this).val()})}).on("change","[data-form] input, [data-form] textarea",function(t){$(".js--contact-form-sent").removeClass("js--contact-form-sent"),e.validateField($(this))}),$(document).on("click","[data-contact-overlay]",function(e){window.innerWidth>767&&(e.preventDefault(),$("html").toggleClass("js--contact-form-open"))})},g.parallax=function(){var e=g.parallax;e.selectors={spacer:"[data-spacer]"},e.classes={},e.variables={},e.cache={spacer:{},parallax:[]},this.roundToNum=function(e,t){return+(Math.round(e+"e+"+t)+"e-"+t)},e.setCache=function(){e.cache.spacer.parent=$("body")},e.setParallax=function(){$("[data-parallax]").each(function(t,a){var n=$(this).find("[data-parallax-child]"),r=$(this).attr("data-parallax");e.onScreen.addItem(a,{screen:{top:"-100%",bottom:"-100%"},target:{top:"50%",bottom:"50%"},onScreenMove:function(e){var t=e.offset,a="";"home-project"===r&&(a=25*(t.top-.5)),"home-flow"===r&&(a=25*(t.top-.5)),"home-people"===r&&(a=12.5*(t.top-.5)),a&&n.css({opacity:1,transform:"translate3d(0, "+roundToNum(a,2)+"vh, 0)"})}})}),$(e.selectors.spacer).each(function(t,a){e.onScreen.addItem(a,{screen:{top:"0%",bottom:"100%"},onScreenMove:function(t){if(g.global.variables.width<768)return!1;var a=t.offset,n=$(this);a.inside.bottom<=0&&n.addClass("js-screenleave--top");var r=n.attr("data-spacer-video");if(a.inside.bottom>0&&a.inside.bottom<=1){if(e.cache.spacer.parent.attr("data-spacer-reversed",n.attr("data-spacer-reversed")).attr("data-logo-hidden","next"===n.attr("data-spacer")),clearTimeout(e.waiting),r){var o=$("#video-"+r)||[];o[0]&&(o[0].play(),n.addClass("js--video-playing"))}}else if(r){var o=$("#video-"+r);o[0]&&(o[0].pause(),n.removeClass("js--video-playing"))}},fireScreenMoveOffScreen:!0})}),e.onScreen.update(),$(document).on("click","[data-video-play]",function(e){e.preventDefault();var t=$(this).attr("data-video-play");$("#video-"+t)[0].play(),$('[data-spacer-video="'+t+'"]').addClass("js--video-playing")})},e.setReveal=function(){$_reveal=$(".reveal--onscreen"),$_reveal.length&&$.each($_reveal,function(t,a){e.onScreen.addItem($(this)[0],{screen:{top:"25%",bottom:"25%"},onScreenEnter:function(){return $(this).addClass("js--revealed"),!1},onScreenLeave:function(){return!1}})})},e.pageLoad=function(){e.onScreen=new OnScreen,e.setCache(),e.setParallax(),e.setReveal(),e.onScreen.update()},e.init=function(){document.documentElement.className+=" html--loaded";e.pageLoad()},e.init()},g.history=function(){var e=g.history;e.dataSet={state:"data-history-state",wrapper:"data-history-wrapper"},e.selectors={state:"["+e.dataSet.state+"]",wrapper:"["+e.dataSet.wrapper+"]"},e.classes={loading:"js--history-loading",transitionIn:"js--history-transition-in",wrapperFaux:"wrapper--faux"},e.variables={loading:!1,noPushState:!1,isCaseStudy:!1},e.cache={};var t=function(){e.cache={root:$("html"),state:$(e.selectors.state),wrapper:$(e.selectors.wrapper)}};e.afterLoad=function(){$("[data-replace-date]").text((new Date).getFullYear()),$("video[autoplay]").each(function(){$(this)[0].play()})},e.loadPage=function(t){return e.variables.loading?!1:(e.cache.root.addClass(e.classes.loading),e.variables.loading=!0,e.variables.href=t,e.variables.href?void $("<div>").load(e.variables.href+" "+e.selectors.wrapper,{},function(t){var a=$(this),n=$(this).find(e.selectors.wrapper),r="",o="";n.length&&(r=n.html(),o=n.attr(e.dataSet.wrapper)),a.addClass(e.classes.wrapperFaux).toggleClass("wrapper--normal","case-study"!==o).toggleClass("wrapper--case-study","case-study"===o),e.variables.isCaseStudy="case-study"===o,g.navigation.toggleNavigation(!0),e.cache.wrapper.before(a),setTimeout(function(){g.navigation.setActive(o),e.cache.state.attr(e.dataSet.state,o),a.addClass(e.classes.transitionIn),setTimeout(function(){e.cache.wrapper.attr(e.dataSet.wrapper,o).html(r),window.scrollTo(0,0),a.remove(),e.afterLoad(),e.cache.root.removeClass(e.classes.loading),e.variables.noPushState||history.pushState({},"",e.variables.href),e.variables.noPushState=!1,g.parallax.pageLoad()},500)},100),e.variables.loading=!1}):(e.variables.loading=!1,!1))},e.init=function(){t(),e.variables.isCaseStudy="case-study"===e.cache.state.attr(e.dataSet.state),e.afterLoad(),$(document).on("click","[data-history]",function(t){t.preventDefault(),e.loadPage($(this).attr("href"))}).on("keydown",function(t){event=event||window.event;var a=!1;a="key"in event?"Escape"===event.key||"Esc"===event.key:27===event.keyCode,a&&e.variables.isCaseStudy&&e.loadPage("/projects")}),window.onpopstate=function(t){t.preventDefault(),e.variables.noPushState=!0,e.loadPage(document.location.href)}},e.init()},$(function(){g._init()});